<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ToadBox Bingo</title>
<style>
  body { 
    font-family: Arial, sans-serif; 
    text-align: center; 
    margin: 0;
    padding: 15px;
  }
  h1 { 
    margin-bottom: 20px; 
    font-size: clamp(24px, 5vw, 36px);
  }
  .grid { 
    display: grid; 
    grid-template-columns: repeat(5, minmax(60px, 100px)); 
    gap: 5px; 
    justify-content: center;
    max-width: 100%;
    margin: 0 auto;
  }
  .cell { 
    width: 100%; 
    aspect-ratio: 1;
    border: 1px solid #333; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    font-size: clamp(14px, 3vw, 20px);
    position: relative; 
    overflow: hidden;
  }
  .cell img {
    max-width: 90%;
    max-height: 90%;
    object-fit: contain;
  }
  .cell-label { 
    position: absolute; 
    top: 5px; 
    left: 5px; 
    font-size: clamp(10px, 2vw, 14px);
    color: gray; 
  }
  .marked::before,
  .marked::after {
    content: '';
    position: absolute;
    width: 100%;
    height: 2px;
    background-color: red;
    top: 50%;
    left: 0;
  }
  .marked::before {
    transform: rotate(45deg);
  }
  .marked::after {
    transform: rotate(-45deg);
  }
</style>
</head>
<body>

<h1 id="title">Bingo Card</h1>
<div class="grid" id="grid">
  <!-- Cells will be injected here -->
</div>

<script>
  const gridElement = document.getElementById('grid');
  const titleElement = document.getElementById('title');

  async function fetchCard() {
    const response = await fetch('/api/get-card');
    const card = await response.json();
    titleElement.textContent = card.title;
    gridElement.innerHTML = '';
    
    card.cells.forEach((row, rowIndex) => {
      row.forEach((cell, colIndex) => {
        const cellElement = document.createElement('div');
        cellElement.className = 'cell' + (cell.marked ? ' marked' : '');
        
        if (rowIndex === 2 && colIndex === 2) {
          const img = document.createElement('img');
          img.src = '/images/free-space.png';
          img.alt = 'Free Space';
          cellElement.appendChild(img);
        } else {
          cellElement.textContent = cell.value || '';
        }

        const labelElement = document.createElement('span');
        labelElement.className = 'cell-label';
        labelElement.textContent = cell.label;
        cellElement.appendChild(labelElement);

        gridElement.appendChild(cellElement);
      });
    });
  }

  fetchCard();
  setInterval(fetchCard, 5000); // Auto-refresh every 5 seconds
</script>

</body>
</html>
